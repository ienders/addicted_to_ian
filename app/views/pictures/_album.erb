<% partitioned_gallery = [] %>
<% (0..album.size - 1).step(5) {|i| partitioned_gallery.push(album.photos[i..i + 4]) } %>

<% partitioned_gallery.each_with_index do |row, i| %>
  <div class = "thumbs" id ="thumbs_row_<%= i %>">
    <% row.each do |photo| %>
      <%= image_tag(photo.thumb_url, :rel => photo.public_filename, :class => 'gallery_image') %>
    <% end %>
  </div>
<% end %>